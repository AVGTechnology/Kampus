{% extends "base.html" %}
{% block content %}
{% load static %}

<div class="content" style="background-color: #dbdbdb;">

    {% if posts %}
    {% for posts in posts %}
    <div style="background-color: #ffffff;">
        <br>
        <div class="row valign-wrapper space">
            <div class="col s15">
                <a href="{% url 'view_user_profile' posts.user.pk %}">
                    <img src={{posts.user.owner.image.url}}
                         width="50px" height="50px"
                         alt="" class="circle">
                </a>
            </div>
            <div class="col s16">
                <b>{{ posts.user}}</b>
                <p><font color="#9e9e9e">{{ posts.user.owner.profession}}</font></p>
            </div>
        </div>

        <div class="space">
            <div class="">
                <b>{{ posts.caption}}</b>
            </div>
            {% if posts.file.url|slice:"-4:" == ".mp4" %}
            <video class="responsive-video" controls>
                <source src={{posts.file.url}} type="video/mp4" style="max-width: 100%;">
            </video>
            {% else %}
            <img class="responsive-img" src={{posts.file.url}} style="max-width: 100%;">
            {% endif %}
        </div>
        <br>
        <div class="row valign-wrapper">
            <div class="col s15">

                {% if user in posts.like.all%}
                <a href="{% url 'like' posts.pk %}">
                 <i class="material-icons" style="font-size: 30px; text-decoration: none; color: red;">favorite</i>
                </a>
                {% else %}
                 <a href="{% url 'like' posts.pk %}">
                    <i class="material-icons" style="font-size: 30px; text-decoration: none; color: #292929">favorite_border</i>
                </a>
                {% endif %}

            </div>

            <div class="col s15">
                <a href="{% url 'comment_view' posts.pk %}">
                    <i class="material-icons"
                       style="font-size: 30px;  text-decoration: none; color: #292929">comment</i>
                </a>
            </div>

            <div class="col s15" >
                <a href="{% url 'chat_page' posts.user.pk %}">
                    <i class="material-icons" style="font-size: 30px; text-decoration: none; color: #292929; transform: rotate(0deg);">send</i>
                </a>
            </div>

            <div class="col s1">
                <a href="{{posts.file.url}}" class="pull-right" download>
                <i class="material-icons right" style="font-size: 30px; text-decoration: none; color: #292929">file_download</i>
                    </a>
            </div>

        </div>

        <div class="row valign-wrapper">
            <div class="col s15">
                <a href="{% url 'likes' posts.pk %}">
                <b style="color: black;">{{posts.like.count}} likes</b>
                </a>
            </div>

            <div class="col s15">
                <a href="{% url 'comment_view' posts.pk %}">

                    View all comments

                </a>
            </div>
        </div>

         {% for comments in comments %}
                    {% if comments.post == posts %}
        <b>{{comments.user}}</b> <font size='3px;' color="#9e9e9e;">  {{ comments.comment|truncatewords:"5"}}</font><br>
                    {% endif %}
                    {% endfor %}
        <!-- <div class="container">
            comments....
         </div>-->

        <div class="row valign-wrapper">
            <div class="col s15">
                <img src={{profile.image.url}}
                     width="30px"
                     height="30px"
                     alt="" class="circle">
            </div>

           <a href="{% url 'comment_view' posts.pk %}">
            <div class="col s15 chip">
                <p><font color="gray">Add a comment...</font></p>
            </div>
           </a>
            <br>
            <div class="col s4">
                <p class="right"><font color="gray">{{posts.timestamp|date:"D d M Y" }}</font></p>
            </div>
        </div>

    </div>


    {% endfor %}
    {% else %}
    <h2><b>No Posts has been created Yet!!</b></h2>
    {% endif %}

</div>

{% endblock %}